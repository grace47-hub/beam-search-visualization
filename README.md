# beam-search-visualization
# LLM λ””μ½”λ”© κ²°μ • μ‹κ°ν™” μΈν„°νμ΄μ¤

Greedy Search vs Beam Search κΈ°λ° λ‹¨μ–΄ μ„ νƒ κ³Όμ •μ μ‹¤μ‹κ°„ μ‹κ°ν™”

## ν”„λ΅μ νΈ κ°μ”

μ΄ ν”„λ΅μ νΈλ” λ€κ·λ¨ μ–Έμ–΄ λ¨λΈ(LLM)μ λ¬Έμ¥ μƒμ„± κ³Όμ •μ„ μ‹κ°ν™”ν•μ—¬, Greedy Searchμ™€ Beam Search μ•κ³ λ¦¬μ¦μ΄ μ–΄λ–»κ² λ‹¨μ–΄λ¥Ό μ„ νƒν•κ³  μ μ§€Β·μ κ±°ν•λ”μ§€λ¥Ό μ§κ΄€μ μΌλ΅ κ΄€μ°°ν•  μ μλ” μ›Ή μΈν„°νμ΄μ¤μ…λ‹λ‹¤.

### μ£Όμ” κΈ°λ¥

1. μ‹¤μ  LLM μ‚¬μ©: GPT-2 κ³„μ—΄ λ¨λΈμ„ μ‚¬μ©ν• μ§„μ§ ν™•λ¥  λ¶„ν¬ κ³„μ‚°
2. λ””μ½”λ”© μ•κ³ λ¦¬μ¦ λΉ„κµ: Greedy Searchμ™€ Beam Searchμ μ‹¤μ‹κ°„ λΉ„κµ
3. λ‹¤μ–‘ν• μ‹κ°ν™”:
   - λ‹¨κ³„λ³„ ν† ν° ν™•λ¥  ννΈλ§µ
   - Beam Search νƒμƒ‰ νΈλ¦¬
   - Beam Width λ³€ν™”μ— λ”°λ¥Έ μ„±λ¥ λΉ„κµ κ·Έλν”„
4. μλ™ν™”λ λΉ„κµ μ‹¤ν—: Beam Width = 1, 3, 5 μλ™ λΉ„κµ

##  λΉ λ¥Έ μ‹μ‘

### 1. ν™κ²½ μ„¤μ •

```bash
# κ°€μƒν™κ²½ μƒμ„± (κ¶μ¥)
python -m venv venv

# κ°€μƒν™κ²½ ν™μ„±ν™”
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# ν¨ν‚¤μ§€ μ„¤μΉ
pip install -r requirements.txt
```

### 2. μ‹¤ν–‰

```bash
streamlit run app.py
```

λΈλΌμ°μ €κ°€ μλ™μΌλ΅ μ—΄λ¦¬λ©° `http://localhost:8501`μ—μ„ μ•±μ΄ μ‹¤ν–‰λ©λ‹λ‹¤.

## π“– μ‚¬μ© λ°©λ²•

### κΈ°λ³Έ μ‚¬μ©

1. λ¨λΈ μ„ νƒ: μ‚¬μ΄λ“λ°”μ—μ„ GPT-2 λ¨λΈ μ„ νƒ (distilgpt2κ°€ κ°€μ¥ λΉ λ¦„)
2. ν”„λ΅¬ν”„νΈ μ…λ ¥: μƒμ„±μ„ μ‹μ‘ν•  ν…μ¤νΈ μ…λ ¥ (μμ–΄ κ¶μ¥)
3. λ””μ½”λ”© μ•κ³ λ¦¬μ¦ μ„ νƒ: Greedy λλ” Beam
4. Beam Width μ΅°μ •: Beam Search μ‚¬μ© μ‹ μ μ§€ν•  ν›„λ³΄ κ²½λ΅ μ μ„¤μ •
5.  μ‹¤ν–‰ λ²„νΌ ν΄λ¦­

### λΉ„κµ μ‹¤ν—

λΉ„κµ μ‹¤ν— λ²„νΌμ„ ν΄λ¦­ν•λ©΄ Beam Width = 1, 3, 5μ— λ€ν• μλ™ λΉ„κµκ°€ μ‹¤ν–‰λ©λ‹λ‹¤.

##  μ¶λ ¥ κ²°κ³Ό μ„¤λ…

### Greedy Search κ²°κ³Ό

- μƒμ„±λ ν…μ¤νΈ: μµμΆ… μƒμ„± λ¬Έμ¥
- λ‹¨κ³„λ³„ ν† ν° μ„ νƒ: κ° λ‹¨κ³„μ—μ„ μ„ νƒλ ν† ν°κ³Ό ν™•λ¥ 
- ν† ν° ν™•λ¥  ννΈλ§µ: λ‹¨κ³„λ³„ μƒμ„ ν† ν°λ“¤μ ν™•λ¥  λ¶„ν¬
- μµμΆ… λ΅κ·Έν™•λ¥ : μƒμ„± κ²½λ΅μ μ΄ μ μ

### Beam Search κ²°κ³Ό

- μƒμ„±λ ν…μ¤νΈ: μµκ³  μ μ κ²½λ΅μ λ¬Έμ¥
- μµκ³  κ²½λ΅ λ‹¨κ³„λ³„ μ„ νƒ: μµμΆ… μ„ νƒλ κ²½λ΅μ ν† ν°λ“¤
- ν† ν° ν™•λ¥  ννΈλ§µ: μµκ³  κ²½λ΅μ λ‹¨κ³„λ³„ ν™•λ¥  λ¶„ν¬
- Beam νƒμƒ‰ μ”μ•½: κ° λ‹¨κ³„μ μ μ§€/νƒμƒ‰/μ κ±° ν›„λ³΄ μ
- Beam Search νΈλ¦¬: ν›„λ³΄ κ²½λ΅μ νΈλ¦¬ κµ¬μ΅° (Graphviz μ‚¬μ©)
- ν†µκ³„:
  - μµμΆ… λ΅κ·Έν™•λ¥ 
  - λ‹¤μ–‘μ„± (μµμΆ… μ μ§€λ κ³ μ  μ¶λ ¥ κ°μ)
  - μ΄ νƒμƒ‰ ν›„λ³΄ μ
  - μ΄ μ κ±° ν›„λ³΄ μ

##  νλΌλ―Έν„° μ„¤λ…

| νλΌλ―Έν„° | μ„¤λ… | κ¶μ¥κ°’ |
|---------|------|--------|
| Beam Width | μ μ§€ν•  ν›„λ³΄ κ²½λ΅ μ | 3-5 |
| μƒμ„±ν•  ν† ν° μ | ν”„λ΅¬ν”„νΈ μ΄ν›„ μƒμ„±ν•  ν† ν° κ°μ | 10-20 |
| ννΈλ§µ ν† ν° κ°μ | ννΈλ§µμ— ν‘μ‹ν•  μƒμ„ ν† ν° μ | 10-15 |

##μ‹¤ν— μμ‹

### ν”„λ΅¬ν”„νΈ μμ‹

- μμ–΄: "I love machine learning because"
- μμ–΄: "The future of artificial intelligence is"
- μμ–΄: "In the year 2050, we will"

> μ£Όμ: GPT-2λ” μμ–΄λ΅ ν•™μµλμ—μΌλ―€λ΅ μμ–΄ ν”„λ΅¬ν”„νΈλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.

##  λ¬Έμ  ν•΄κ²°

### Graphviz μ¤λ¥

Graphvizκ°€ μ„¤μΉλμ§€ μ•μ€ κ²½μ° νΈλ¦¬ μ‹κ°ν™”κ°€ ν‘μ‹λμ§€ μ•μ§€λ§, ν…μ΄λΈ” ν•νƒλ΅ λ€μ²΄ ν‘μ‹λ©λ‹λ‹¤.

Graphviz μ„¤μΉ (μ„ νƒμ‚¬ν•­):
- Windows: [graphviz.org](https://graphviz.org/download/)μ—μ„ μ„¤μΉ ν›„ PATH μ¶”κ°€
- macOS: `brew install graphviz`
- Linux: `sudo apt-get install graphviz`

### λ©”λ¨λ¦¬ λ¶€μ΅±

μƒμ„± ν† ν° μλ¥Ό μ¤„μ΄κ±°λ‚ λ” μ‘μ€ λ¨λΈ(distilgpt2)μ„ μ‚¬μ©ν•μ„Έμ”.

##  ν”„λ΅μ νΈ κµ¬μ΅°

```
llm_decoding_viz/
β”β”€β”€ app.py              # λ©”μΈ Streamlit μ•±
β”β”€β”€ requirements.txt    # ν•„μ” ν¨ν‚¤μ§€ λ©λ΅
β””β”€β”€ README.md          # ν”„λ΅μ νΈ μ„¤λ…μ„
```

##  ν•™μ μ  μμ

μ΄ ν”„λ΅μ νΈλ” λ‹¤μκ³Ό κ°™μ€ κµμ΅μ  κ°€μΉλ¥Ό μ κ³µν•©λ‹λ‹¤:

1. LLM λ‚΄λ¶€ λ™μ‘ μ΄ν•΄: λΈ”λ™λ°•μ¤κ°€ μ•„λ‹ κ΄€μ°° κ°€λ¥ν• μ‹μ¤ν…μΌλ΅ LLM ν•™μµ
2. μ•κ³ λ¦¬μ¦ λΉ„κµ: Greedy vs Beam Searchμ μ‹¤μ§μ  μ°¨μ΄ ν™•μΈ
3. νƒμƒ‰ μ „λµ λ¶„μ„: νƒμƒ‰ ν­κ³Ό κ²°κ³Ό ν’μ§/κ³„μ‚° λΉ„μ©μ νΈλ μ΄λ“μ¤ν”„ μ΄ν•΄
4. μ‹¤μ©μ  κµ¬ν„: μ΄λ΅ μ„ μ‹¤μ  μ‘λ™ν•λ” λ„κµ¬λ΅ κµ¬ν„

## π“ κΈ°μ  μ¤νƒ

- Python 3.10+
- Streamlit: μ›Ή μΈν„°νμ΄μ¤
- Transformers (Hugging Face): GPT-2 λ¨λΈ
- PyTorch: λ”¥λ¬λ‹ ν”„λ μ„μ›ν¬
- Matplotlib: μ‹κ°ν™”
- Pandas: λ°μ΄ν„° μ²λ¦¬

##  μ¤‘μ” μ‚¬ν•­

### Beam Search κµ¬ν„ λ°©μ‹

λ³Έ κµ¬ν„μ—μ„λ” κ³„μ‚° ν¨μ¨μ„ μ„ν•΄ κ° beamμ—μ„ μƒμ„ `beam_width * 2`κ°μ ν† ν°λ§ ν™•μ¥ν•©λ‹λ‹¤.

ν‘μ¤€ Beam Searchλ” κ° beamμ—μ„ μ „μ²΄ μ–΄ν(vocab)λ¥Ό ν™•μ¥ν• ν›„ μƒμ„ `beam_width`κ°λ¥Ό μ μ§€ν•μ§€λ§, μ΄λ” κ³„μ‚°λ‰μ΄ λ§¤μ° λ§μµλ‹λ‹¤.

λ³Έ κµ¬ν„μ€ μ‹¤μ©μ μΈ νƒ€ν‘μ•μΌλ΅:
- Beam Searchμ ν•µμ‹¬ κ°λ…(λ‹¤μ¤‘ ν›„λ³΄ μ μ§€) μ μ§€
- μ‹¤μ‹κ°„ μ‹κ°ν™” κ°€λ¥ν• μ†λ„
- κµμ΅ λ©μ μ— μ ν•©ν• κ²°κ³Ό

##  λΌμ΄μ„ μ¤
μ΄ ν”„λ΅μ νΈλ” κµμ΅ λ©μ μΌλ΅ μμ λ΅­κ² μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

##  μ‘μ„±μ

κ³ λ“±ν•™κµ νƒκµ¬ ν”„λ΅μ νΈ
- μ „ νƒκµ¬: Beam Search μ•κ³ λ¦¬μ¦ λ¶„μ„
- λ³Έ νƒκµ¬: λ””μ½”λ”© κ³Όμ • μ‹κ°ν™” μΈν„°νμ΄μ¤ κµ¬ν„
